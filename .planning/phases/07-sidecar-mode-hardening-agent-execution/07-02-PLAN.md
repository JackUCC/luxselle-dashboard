---
phase: 07-sidecar-mode-hardening-agent-execution
plan: "02"
type: execute
wave: 2
depends_on:
  - "07-01"
files_modified:
  - tests/e2e/sidecar-flow.spec.ts
  - tests/e2e/evaluator.spec.ts
  - tests/e2e/inventory.spec.ts
  - tests/e2e/invoices.spec.ts
  - docs/planning/PLAN.md
  - docs/planning/STATUS_AND_PLAN.md
autonomous: true
requirements:
  - SIDE-03
  - SIDE-04
user_setup:
  - Ensure Playwright Chromium is installed (`npx playwright install chromium`) before running sidecar E2E.
must_haves:
  truths:
    - Shared actions behave consistently in Overview and Sidecar where workflows overlap.
    - Evaluator -> Inventory -> Invoices sidecar journey executes without P0 regressions.
  artifacts:
    - tests/e2e/sidecar-flow.spec.ts
    - tests/e2e/evaluator.spec.ts
    - tests/e2e/inventory.spec.ts
    - tests/e2e/invoices.spec.ts
  key_links:
    - tests/e2e/sidecar-flow.spec.ts -> src/lib/LayoutModeContext.tsx
    - tests/e2e/sidecar-flow.spec.ts -> src/pages/BuyBox/EvaluatorView.tsx
    - tests/e2e/sidecar-flow.spec.ts -> src/pages/Inventory/InventoryView.tsx
    - tests/e2e/sidecar-flow.spec.ts -> src/pages/Invoices/InvoicesView.tsx
---

<objective>
Prove sidecar behavior parity and release readiness with focused automated regression coverage and planning-state updates.

Purpose: Convert sidecar hardening work into enforceable quality gates before phase signoff.
Output: Sidecar-specific E2E coverage, strengthened route tests, and updated planning status.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-sidecar-mode-hardening-agent-execution/07-CONTEXT.md
@tests/e2e/evaluator.spec.ts
@tests/e2e/inventory.spec.ts
@tests/e2e/invoices.spec.ts
@src/lib/LayoutModeContext.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add dedicated sidecar journey E2E coverage</name>
  <files>tests/e2e/sidecar-flow.spec.ts</files>
  <action>Create a sidecar-focused E2E spec that exercises evaluator -> inventory -> invoices flow in `?mode=sidecar`, asserts compact-mode interaction reliability, and verifies mode persistence/context expectations across route transitions.</action>
  <verify>npm run test:e2e -- tests/e2e/sidecar-flow.spec.ts</verify>
  <done>New sidecar E2E spec runs green and fails when core sidecar journey behavior regresses.</done>
</task>

<task type="auto">
  <name>Task 2: Strengthen existing evaluator, inventory, and invoices tests for sidecar parity</name>
  <files>tests/e2e/evaluator.spec.ts, tests/e2e/inventory.spec.ts, tests/e2e/invoices.spec.ts</files>
  <action>Extend existing E2E suites with mode-aware assertions so overlapping actions behave consistently in Overview and Sidecar. Keep tests deterministic and avoid coupling to cosmetic styling details.</action>
  <verify>npm run test:e2e -- tests/e2e/evaluator.spec.ts tests/e2e/inventory.spec.ts tests/e2e/invoices.spec.ts</verify>
  <done>Core route E2E suites include explicit parity checks and pass for sidecar-related behavior.</done>
</task>

<task type="auto">
  <name>Task 3: Reflect QA gate completion in planning docs</name>
  <files>docs/planning/PLAN.md, docs/planning/STATUS_AND_PLAN.md</files>
  <action>Update planning/status docs to capture executed sidecar QA gates, any residual risks, and explicit readiness status for Phase 7 closure decisions.</action>
  <verify>npm run typecheck</verify>
  <done>Planning docs accurately reflect sidecar QA outcomes and next release decision point.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run typecheck`
- [ ] `npm run test:e2e -- tests/e2e/sidecar-flow.spec.ts`
- [ ] `npm run test:e2e -- tests/e2e/evaluator.spec.ts tests/e2e/inventory.spec.ts tests/e2e/invoices.spec.ts`
</verification>

<success_criteria>

- Sidecar journey test coverage exists and is executable.
- Overview/Sidecar parity checks are codified in E2E suites.
- Planning docs reflect QA status and release-readiness confidence.
- Phase 7 can be assessed for completion with objective pass/fail evidence.

</success_criteria>

<output>
After completion, create `.planning/phases/07-sidecar-mode-hardening-agent-execution/07-02-SUMMARY.md`
</output>
